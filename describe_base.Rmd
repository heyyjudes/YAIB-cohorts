---
title: "Description of ICU mortality data"
output: html_document
date: "2022-09-27"
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}

library(data.table)
library(tidyverse)
library(gtsummary)
library(testthat)

conf <- ricu:::read_json("config.json")
srcs <- c("mimic", "miiv", "eicu", "hirid", "aumc")

knitr::opts_chunk$set(echo=TRUE)

```

```{r load}

load_data <- function(src) {
  path <- file.path(conf$output_dir, "base", src)
  arrow::read_parquet(file.path(path, "sta.parquet"))
}

data <- srcs %>% 
  set_names() %>% 
  map(load_data) %>% 
  bind_rows(.id="src")

```

```{r describe-static}

data[, .N, by = src]
map(data, ~ summary(.))

tbl_strata(data, strata="src", tbl_summary)

```
